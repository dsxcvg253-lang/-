<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="site-title">امتداد - متجر إلكتروني</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --dark-bg: #121212;
            --medium-bg: #1e1e1e;
            --light-bg: #2d2d2d;
            --primary-color: #0a3d2d;
            --secondary-color: #117a4e;
            --accent-color: #1aa86a;
            --text-color: #f1f1f1;
            --error-color: #cf6679;
            --sold-color: #ff4d4d;
            --category-color: #2a6b57;
            --cart-color: #1aa86a;
            --button-color: #0a3d2d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--dark-bg);
            color: var(--text-color);
            line-height: 1.6;
            padding-bottom: 60px;
            transition: background-color 0.3s, color 0.3s;
            background-image: var(--background-image, none);
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        
        .mobile-video-banner {
            display: none;
            width: 100%;
            height: 120px;
            overflow: hidden;
            position: relative;
        }
        
        .mobile-video-banner video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .close-banner {
            position: absolute;
            top: 5px;
            left: 5px;
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            z-index: 10;
        }
        
        .floating-image {
            position: fixed;
            z-index: 999;
            width: 80px;
            height: 80px;
            object-fit: contain;
            pointer-events: none;
            display: none;
        }
        
        header {
            background-color: var(--medium-bg);
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .logo img {
            height: 50px;
            margin-left: 15px;
            border-radius: 5px;
            object-fit: cover;
        }
        
        .logo h1 {
            color: var(--accent-color);
            font-size: 1.8rem;
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 20px;
        }
        
        nav ul li a {
            color: var(--text-color);
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        
        nav ul li a:hover {
            background-color: var(--primary-color);
        }
        
        .admin-indicator {
            background-color: var(--primary-color);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            display: none;
        }
        
        .cart-icon {
            position: relative;
            cursor: pointer;
            font-size: 1.5rem;
            margin-right: 20px;
            color: var(--cart-color);
        }
        
        .cart-count {
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: var(--cart-color);
            color: var(--dark-bg);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }
        
        .categories {
            display: flex;
            overflow-x: auto;
            gap: 10px;
            padding: 1rem 0;
            margin-bottom: 1rem;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .categories::-webkit-scrollbar {
            display: none;
        }
        
        .category {
            background-color: var(--category-color);
            padding: 8px 15px;
            border-radius: 20px;
            white-space: nowrap;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .category.active {
            background-color: var(--accent-color);
            color: var(--dark-bg);
            font-weight: bold;
        }
        
        .category:hover {
            background-color: var(--accent-color);
            color: var(--dark-bg);
        }
        
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .product {
            background-color: var(--medium-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s;
            display: flex;
            flex-direction: column;
            height: 100%;
            cursor: pointer;
        }
        
        .product.sold::before {
            content: 'تم البيع';
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: var(--sold-color);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
            z-index: 2;
        }
        
        .product:hover {
            transform: translateY(-5px);
        }
        
        .product-image {
            width: 100%;
            height: 200px;
            overflow: hidden;
        }
        
        .product img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .product-info {
            padding: 15px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .product-title {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: var(--accent-color);
        }
        
        .product-price {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: var(--accent-color);
            font-weight: bold;
        }
        
        .product-description {
            font-size: 0.9rem;
            margin-bottom: 15px;
            color: #ccc;
            flex-grow: 1;
        }
        
        .product-actions {
            display: flex;
            gap: 10px;
        }
        
        .add-to-cart {
            background-color: var(--button-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
            transition: background-color 0.3s;
        }
        
        .add-to-cart:hover {
            background-color: var(--secondary-color);
        }
        
        .remove-product {
            background-color: var(--error-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            display: none;
        }
        
        .mark-as-sold {
            background-color: var(--sold-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            display: none;
        }
        
        .cart-icon-btn {
            margin-left: 8px;
        }
        
        .admin-panel {
            background-color: var(--medium-bg);
            padding: 20px;
            border-radius: 8px;
            margin-top: 2rem;
            display: none;
        }
        
        .admin-panel h2 {
            color: var(--accent-color);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .admin-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--light-bg);
            flex-wrap: wrap;
        }
        
        .admin-tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }
        
        .admin-tab.active {
            border-bottom: 3px solid var(--accent-color);
            color: var(--accent-color);
        }
        
        .admin-form {
            display: grid;
            gap: 15px;
        }
        
        .admin-form input, .admin-form textarea, .admin-form button, .admin-form select, .admin-form .file-input {
            padding: 10px;
            border-radius: 4px;
            border: 1px solid var(--light-bg);
            background-color: var(--light-bg);
            color: var(--text-color);
        }
        
        .file-input {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .file-input input[type="file"] {
            display: none;
        }
        
        .file-input-label {
            background-color: var(--primary-color);
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .file-input-label:hover {
            background-color: var(--secondary-color);
        }
        
        .admin-form button {
            background-color: var(--primary-color);
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .admin-form button:hover {
            background-color: var(--secondary-color);
        }
        
        .color-picker {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin: 15px 0;
            max-height: 300px;
            overflow-y: auto;
            padding: 10px;
            background: var(--light-bg);
            border-radius: 8px;
        }
        
        .color-option {
            height: 40px;
            border-radius: 4px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: transform 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            text-align: center;
            word-break: break-word;
            padding: 2px;
        }
        
        .color-option:hover {
            transform: scale(1.05);
        }
        
        .color-option.active {
            border-color: white;
            box-shadow: 0 0 5px white;
        }
        
        .color-section {
            margin-bottom: 20px;
            padding: 15px;
            background: var(--light-bg);
            border-radius: 8px;
        }
        
        .color-section h4 {
            margin-bottom: 10px;
            color: var(--accent-color);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: var(--medium-bg);
            padding: 2rem;
            border-radius: 8px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal h2 {
            color: var(--accent-color);
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .modal p {
            margin-bottom: 1.5rem;
            text-align: center;
        }
        
        .cart-items {
            margin: 20px 0;
        }
        
        .cart-item {
            display: flex;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid var(--light-bg);
        }
        
        .cart-item img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
            margin-left: 10px;
        }
        
        .cart-item-info {
            flex-grow: 1;
        }
        
        .cart-item-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .cart-item-price {
            color: var(--accent-color);
        }
        
        .remove-from-cart {
            background: none;
            border: none;
            color: var(--error-color);
            cursor: pointer;
            font-size: 1.2rem;
        }
        
        .cart-total {
            text-align: center;
            font-size: 1.2rem;
            margin: 20px 0;
            color: var(--accent-color);
            font-weight: bold;
        }
        
        .telegram-link {
            display: inline-block;
            background-color: #0088cc;
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            text-decoration: none;
            margin: 10px auto;
            cursor: pointer;
            text-align: center;
        }
        
        .close-modal {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 15px;
            display: block;
            width: 100%;
        }
        
        footer {
            background-color: var(--medium-bg);
            padding: 2rem 1rem;
            text-align: center;
            margin-top: 3rem;
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--primary-color);
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            display: none;
            z-index: 1000;
        }
        
        .change-password {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--light-bg);
        }
        
        .empty-cart-message {
            text-align: center;
            padding: 20px;
            color: #ccc;
        }
        
        .message-item {
            background-color: var(--light-bg);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        
        .message-content {
            margin-bottom: 10px;
        }
        
        .message-date {
            font-size: 0.8rem;
            color: #999;
            text-align: left;
        }
        
        .image-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1100;
            justify-content: center;
            align-items: center;
        }
        
        .image-modal-content {
            max-width: 90%;
            max-height: 90%;
        }
        
        .image-modal-content img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .close-image-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 2rem;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            header {
                flex-wrap: wrap;
            }
            
            nav {
                order: 3;
                width: 100%;
                margin-top: 10px;
            }
            
            nav ul {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .gallery {
                grid-template-columns: repeat(auto-fill, minmax(100%, 1fr));
            }
            
            .categories {
                padding: 0.5rem 0;
            }
            
            .logo h1 {
                font-size: 1.5rem;
            }
            
            nav ul li {
                margin-left: 10px;
                margin-bottom: 5px;
            }
            
            .mobile-video-banner {
                display: block;
            }
            
            .admin-tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
            }
        }
        
        @media (min-width: 769px) {
            .mobile-video-banner {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="mobile-video-banner" id="mobile-video-banner">
        <button class="close-banner" id="close-banner">&times;</button>
        <video id="banner-video" loop muted autoplay>
        </video>
    </div>

    <img class="floating-image" id="floating-image" src="" alt="صورة متحركة">

    <header>
        <div class="logo" id="logo-container">
            <img src="" alt="شعار الموقع" id="site-logo">
            <h1 id="site-name">امتداد</h1>
        </div>
        <nav>
            <ul>
                <li><a href="#" class="nav-link" data-section="home">الرئيسية</a></li>
                <li><a href="#" class="nav-link" data-section="products">منتجاتنا</a></li>
                <li><a href="#" class="nav-link" data-section="messages">امتداد</a></li>
                <li><a href="#" class="nav-link" data-section="contact">اتصل بنا</a></li>
                <li><a href="#" id="admin-login">دخول المدير</a></li>
            </ul>
        </nav>
        <div class="cart-icon" id="cart-icon">
            <i class="fas fa-shopping-cart"></i>
            <div class="cart-count" id="cart-count">0</div>
        </div>
        <div class="admin-indicator" id="admin-indicator">وضع المدير</div>
    </header>

    <div class="container">
        <div class="categories" id="categories-container">
        </div>

        <section class="gallery" id="products-gallery">
        </section>

        <section id="messages-section" style="display: none;">
            <h2 style="text-align: center; margin-bottom: 20px; color: var(--accent-color);">قسم امتداد</h2>
            <div id="messages-container">
            </div>
        </section>

        <section class="admin-panel" id="admin-panel">
            <h2>لوحة تحكم المدير</h2>
            
            <div class="admin-tabs">
                <div class="admin-tab active" data-tab="products">إدارة المنتجات</div>
                <div class="admin-tab" data-tab="categories">إدارة الأقسام</div>
                <div class="admin-tab" data-tab="messages">إدارة الرسائل</div>
                <div class="admin-tab" data-tab="colors">تخصيص الألوان</div>
                <div class="admin-tab" data-tab="media">إدارة الوسائط</div>
                <div class="admin-tab" data-tab="settings">الإعدادات</div>
            </div>
            
            <div class="admin-tab-content" id="admin-products">
                <h3>إضافة منتج جديد</h3>
                <form class="admin-form" id="add-product-form">
                    <input type="text" id="product-title" placeholder="اسم المنتج" required>
                    <input type="text" id="product-price" placeholder="سعر المنتج (مثال: 5 ر.س)" required>
                    <select id="product-category" required>
                        <option value="">اختر القسم</option>
                    </select>
                    <textarea id="product-description" placeholder="وصف المنتج" rows="3" required></textarea>
                    
                    <div class="file-input">
                        <span id="file-name">لم يتم اختيار صورة</span>
                        <label for="product-image" class="file-input-label">اختر صورة</label>
                        <input type="file" id="product-image" accept="image/*" required>
                    </div>
                    
                    <button type="submit">إضافة المنتج</button>
                </form>
            </div>
            
            <div class="admin-tab-content" id="admin-categories" style="display: none;">
                <h3>إضافة قسم جديد</h3>
                <form class="admin-form" id="add-category-form">
                    <input type="text" id="category-name" placeholder="اسم القسم" required>
                    <button type="submit">إضافة القسم</button>
                </form>
                
                <h3 style="margin-top: 20px;">الأقسام الحالية</h3>
                <ul id="categories-list">
                </ul>
            </div>
            
            <div class="admin-tab-content" id="admin-messages" style="display: none;">
                <h3>إرسال رسالة جديدة</h3>
                <form class="admin-form" id="add-message-form">
                    <textarea id="message-content" placeholder="محتوى الرسالة" rows="4" required></textarea>
                    <button type="submit">نشر الرسالة</button>
                </form>
                
                <h3 style="margin-top: 20px;">الرسائل المنشورة</h3>
                <div id="admin-messages-list">
                </div>
            </div>
            
            <div class="admin-tab-content" id="admin-colors" style="display: none;">
                <h3>تخصيص ألوان الموقع</h3>
                
                <div class="color-section">
                    <h4>لون الخلفية:</h4>
                    <div class="color-picker" id="bg-color-picker">
                    </div>
                </div>
                
                <div class="color-section">
                    <h4>لون العناصر الأساسية:</h4>
                    <div class="color-picker" id="primary-color-picker">
                    </div>
                </div>
                
                <div class="color-section">
                    <h4>لون النص:</h4>
                    <div class="color-picker" id="text-color-picker">
                    </div>
                </div>
                
                <div class="color-section">
                    <h4>لون الأزرار:</h4>
                    <div class="color-picker" id="button-color-picker">
                    </div>
                </div>
                
                <div class="color-section">
                    <h4>لون السلة:</h4>
                    <div class="color-picker" id="cart-color-picker">
                    </div>
                </div>
                
                <button id="reset-colors" style="margin-top: 20px; width: 100%;">إعادة الضبط إلى الألوان الافتراضية</button>
            </div>
            
            <div class="admin-tab-content" id="admin-media" style="display: none;">
                <h3>إعدادات الوسائط</h3>
                
                <div class="color-section">
                    <h4>فيديو الجوال (يظهر فقط على الهواتف):</h4>
                    <div class="file-input">
                        <span id="video-file-name">لم يتم اختيار فيديو</span>
                        <label for="mobile-video" class="file-input-label">اختر فيديو</label>
                        <input type="file" id="mobile-video" accept="video/*">
                    </div>
                    <button id="remove-video" style="margin-top: 10px; width: 100%; background: var(--error-color);">إزالة الفيديو</button>
                </div>
                
                <div class="color-section">
                    <h4>صورة متحركة في الموقع:</h4>
                    <div class="file-input">
                        <span id="floating-image-file-name">لم يتم اختيار صورة</span>
                        <label for="floating-image-input" class="file-input-label">اختر صورة</label>
                        <input type="file" id="floating-image-input" accept="image/*">
                    </div>
                    <div class="admin-form">
                        <label for="animation-speed">سرعة الحركة:</label>
                        <input type="range" id="animation-speed" min="1" max="10" value="5">
                        <label for="animation-direction">اتجاه الحركة:</label>
                        <select id="animation-direction">
                            <option value="random">عشوائي</option>
                            <option value="horizontal">أفقي</option>
                            <option value="vertical">عمودي</option>
                            <option value="circular">دائري</option>
                        </select>
                    </div>
                    <button id="remove-floating-image" style="margin-top: 10px; width: 100%; background: var(--error-color);">إزالة الصورة المتحركة</button>
                </div>
                
                <div class="color-section">
                    <h4>خلفية الموقع:</h4>
                    <div class="file-input">
                        <span id="background-file-name">لم يتم اختيار صورة خلفية</span>
                        <label for="background-image" class="file-input-label">اختر صورة خلفية</label>
                        <input type="file" id="background-image" accept="image/*">
                    </div>
                    <button id="remove-background" style="margin-top: 10px; width: 100%; background: var(--error-color);">إزالة الخلفية</button>
                </div>
            </div>
            
            <div class="admin-tab-content" id="admin-settings" style="display: none;">
                <div class="color-section">
                    <h3>تغيير اسم الموقع</h3>
                    <form class="admin-form" id="change-site-name-form">
                        <input type="text" id="new-site-name" placeholder="اسم الموقع الجديد" required>
                        <button type="submit">تغيير الاسم</button>
                    </form>
                </div>
                
                <div class="change-password">
                    <h3>تغيير كلمة المرور</h3>
                    <form class="admin-form" id="change-password-form">
                        <input type="password" id="current-password" placeholder="كلمة المرور الحالية" required>
                        <input type="password" id="new-password" placeholder="كلمة المرور الجديدة" required>
                        <button type="submit">تغيير كلمة المرور</button>
                    </form>
                </div>
            </div>
        </section>
    </div>

    <div class="modal" id="purchase-modal">
        <div class="modal-content">
            <h2>سلة التسوق</h2>
            <div class="cart-items" id="cart-items">
            </div>
            <div class="cart-total" id="cart-total">المجموع: 0 ر.س</div>
            <button class="telegram-link" id="confirm-purchase">تأكيد الطلب والشراء</button>
            <button class="close-modal" id="close-modal">موافق</button>
        </div>
    </div>

    <div class="modal" id="telegram-modal">
        <div class="modal-content">
            <h2>شكراً لطلبك!</h2>
            <p>لإكمال عملية الشراء، يرجى التواصل معنا على Telegram:</p>
            <div class="telegram-link" id="telegram-link">@Y_XX</div>
            <p>تم نسخ المعرف، يمكنك لصقه في Telegram الآن</p>
            <button class="close-modal" id="close-telegram-modal">موافق</button>
        </div>
    </div>

    <div class="image-modal" id="image-modal">
        <span class="close-image-modal" id="close-image-modal">&times;</span>
        <div class="image-modal-content">
            <img id="expanded-image" src="">
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <footer>
        <p>© 2025 امتداد. جميع الحقوق محفوظة لـ @Y_XX</p>
    </footer>

    <script>
        // بيانات التخزين
        let products = JSON.parse(localStorage.getItem('extension_products')) || [];
        let categories = JSON.parse(localStorage.getItem('extension_categories')) || ['تقسامات مواد', 'قسم آخر', 'ارقام وهيبة'];
        let messages = JSON.parse(localStorage.getItem('extension_messages')) || [];
        let cart = JSON.parse(localStorage.getItem('extension_cart')) || [];
        let isAdmin = localStorage.getItem('extension_admin') === 'true';
        const defaultPassword = '775019707بامحرز';
        let adminPassword = localStorage.getItem('extension_password') || defaultPassword;
        let currentCategory = 'الكل';
        let currentSection = 'products';
        
        // قائمة الألوان الكاملة
        const colorPalette = [
            { name: "جديد", color: "#F0F0F0" }, { name: "الجزائيت", color: "#E8E8E8" }, { name: "ظل", color: "#D3D3D3" },
            { name: "رمایه", color: "#C0C0C0" }, { name: "تابع", color: "#A9A9A9" }, { name: "المرمر", color: "#808080" },
            { name: "لؤلؤة", color: "#696969" }, { name: "أبيض", color: "#FFFFFF" }, { name: "دخان", color: "#F5F5F5" },
            { name: "فصلة", color: "#DCDCDC" }, { name: "سحاب", color: "#D3D3D3" }, { name: "بجوتر", color: "#C0C0C0" },
            { name: "قطن", color: "#F8F8FF" }, { name: "قشرة", color: "#FFF5EE" }, { name: "يبض", color: "#FDF5E6" },
            { name: "عاج", color: "#FFFFF0" }, { name: "فحم", color: "#36454F" }, { name: "أسود", color: "#000000" },
            { name: "أسمود", color: "#1C1C1C" }, { name: "ذهب", color: "#FFD700" }, { name: "أصفر", color: "#FFFF00" },
            { name: "عسل", color: "#F0E68C" }, { name: "برتقالي", color: "#FFA500" }, { name: "ناري", color: "#FF4500" },
            { name: "أحمر", color: "#FF0000" }, { name: "وردي", color: "#FFC0CB" }, { name: "بنفسجي", color: "#8A2BE2" },
            { name: "أزرق", color: "#0000FF" }, { name: "تركواز", color: "#40E0D0" }, { name: "أخضر", color: "#008000" },
            { name: "زمردي", color: "#50C878" }, { name: "بني", color: "#A52A2A" }, { name: "رملي", color: "#F4A460" },
            { name: "كريمي", color: "#FFFDD0" }, { name: "فضي", color: "#C0C0C0" }, { name: "ذهبي", color: "#FFD700" },
            { name: "نحاسي", color: "#B87333" }, { name: "برونزي", color: "#CD7F32" }, { name: "زهري", color: "#FF69B4" },
            { name: "أرجواني", color: "#800080" }, { name: "نيلي", color: "#4B0082" }, { name: "سماوي", color: "#87CEEB" },
            { name: "فيروزي", color: "#30D5C8" }, { name: "زيتوني", color: "#808000" }, { name: "ليموني", color: "#FFF44F" },
            { name: "خوخي", color: "#FFDAB9" }, { name: "لافندر", color: "#E6E6FA" }, { name: "مرجاني", color: "#FF7F50" },
            { name: "سلمون", color: "#FA8072" }, { name: "قرمزي", color: "#DC143C" }, { name: "كستنائي", color: "#800000" },
            { name: "بورجوندي", color: "#800020" }, { name: "زيتي", color: "#708238" }, { name: "اخضر بحري", color: "#2E8B57" },
            { name: "اخضر غامق", color: "#006400" }, { name: "ازرق فاتح", color: "#ADD8E6" }, { name: "ازرق غامق", color: "#00008B" },
            { name: "بنفسجي فاتح", color: "#9370DB" }, { name: "بنفسجي غامق", color: "#483D8B" }
        ];
        
        // عناصر DOM
        const productsGallery = document.getElementById('products-gallery');
        const categoriesContainer = document.getElementById('categories-container');
        const messagesContainer = document.getElementById('messages-container');
        const messagesSection = document.getElementById('messages-section');
        const cartCount = document.getElementById('cart-count');
        const cartIcon = document.getElementById('cart-icon');
        const adminLogin = document.getElementById('admin-login');
        const adminPanel = document.getElementById('admin-panel');
        const adminIndicator = document.getElementById('admin-indicator');
        const addProductForm = document.getElementById('add-product-form');
        const productImageInput = document.getElementById('product-image');
        const fileNameSpan = document.getElementById('file-name');
        const productCategorySelect = document.getElementById('product-category');
        const purchaseModal = document.getElementById('purchase-modal');
        const telegramModal = document.getElementById('telegram-modal');
        const cartItemsContainer = document.getElementById('cart-items');
        const cartTotalElement = document.getElementById('cart-total');
        const confirmPurchaseButton = document.getElementById('confirm-purchase');
        const telegramLinkElement = document.getElementById('telegram-link');
        const closeModal = document.getElementById('close-modal');
        const closeTelegramModal = document.getElementById('close-telegram-modal');
        const notification = document.getElementById('notification');
        const siteLogo = document.getElementById('site-logo');
        const logoContainer = document.getElementById('logo-container');
        const changePasswordForm = document.getElementById('change-password-form');
        const addCategoryForm = document.getElementById('add-category-form');
        const categoriesList = document.getElementById('categories-list');
        const adminTabs = document.querySelectorAll('.admin-tab');
        const adminTabContents = document.querySelectorAll('.admin-tab-content');
        const navLinks = document.querySelectorAll('.nav-link');
        const addMessageForm = document.getElementById('add-message-form');
        const adminMessagesList = document.getElementById('admin-messages-list');
        const imageModal = document.getElementById('image-modal');
        const expandedImage = document.getElementById('expanded-image');
        const closeImageModal = document.getElementById('close-image-modal');
        const resetColorsButton = document.getElementById('reset-colors');
        const mobileVideoBanner = document.getElementById('mobile-video-banner');
        const bannerVideo = document.getElementById('banner-video');
        const closeBanner = document.getElementById('close-banner');
        const mobileVideoInput = document.getElementById('mobile-video');
        const videoFileName = document.getElementById('video-file-name');
        const removeVideoButton = document.getElementById('remove-video');
        const floatingImage = document.getElementById('floating-image');
        const floatingImageInput = document.getElementById('floating-image-input');
        const floatingImageFileName = document.getElementById('floating-image-file-name');
        const removeFloatingImageButton = document.getElementById('remove-floating-image');
        const animationSpeed = document.getElementById('animation-speed');
        const animationDirection = document.getElementById('animation-direction');
        const backgroundImageInput = document.getElementById('background-image');
        const backgroundFileName = document.getElementById('background-file-name');
        const removeBackgroundButton = document.getElementById('remove-background');
        const changeSiteNameForm = document.getElementById('change-site-name-form');
        const newSiteNameInput = document.getElementById('new-site-name');
        const siteNameElement = document.getElementById('site-name');
        const siteTitleElement = document.getElementById('site-title');
        
        // متغيرات للصورة المتحركة
        let floatingImageInterval;
        let floatingImageVisible = false;
        let currentAnimationDirection = 'random';
        
        // تحديث واجهة المستخدم
        function updateUI() {
            cartCount.textContent = cart.length;
            renderCategories();
            
            if (currentSection === 'products') {
                productsGallery.style.display = 'grid';
                messagesSection.style.display = 'none';
                renderProducts();
            } else if (currentSection === 'messages') {
                productsGallery.style.display = 'none';
                messagesSection.style.display = 'block';
                renderMessages();
            }
            
            updateCategoryOptions();
            renderCategoriesList();
            renderAdminMessagesList();
            renderColorPickers();
            applySavedMedia();
            
            if (isAdmin) {
                adminPanel.style.display = 'block';
                adminIndicator.style.display = 'block';
                adminLogin.textContent = 'خروج المدير';
                document.querySelectorAll('.remove-product, .mark-as-sold').forEach(btn => {
                    btn.style.display = 'block';
                });
            } else {
                adminPanel.style.display = 'none';
                adminIndicator.style.display = 'none';
                adminLogin.textContent = 'دخول المدير';
                document.querySelectorAll('.remove-product, .mark-as-sold').forEach(btn => {
                    btn.style.display = 'none';
                });
            }
            
            applySavedColors();
            applySavedSiteName();
        }
        
        // تطبيق الألوان المحفوظة
        function applySavedColors() {
            const savedColors = JSON.parse(localStorage.getItem('extension_colors')) || {};
            for (const [key, value] of Object.entries(savedColors)) {
                document.documentElement.style.setProperty(`--${key}`, value);
            }
        }
        
        // تطبيق الوسائط المحفوظة
        function applySavedMedia() {
            const savedMedia = JSON.parse(localStorage.getItem('extension_media')) || {};
            
            if (savedMedia.mobileVideo) {
                bannerVideo.src = savedMedia.mobileVideo;
                mobileVideoBanner.style.display = 'block';
            } else {
                mobileVideoBanner.style.display = 'none';
            }
            
            if (savedMedia.floatingImage) {
                floatingImage.src = savedMedia.floatingImage;
                floatingImage.style.display = 'block';
                floatingImageVisible = true;
                startFloatingAnimation();
            } else {
                floatingImage.style.display = 'none';
                floatingImageVisible = false;
                stopFloatingAnimation();
            }
            
            if (savedMedia.backgroundImage) {
                document.body.style.backgroundImage = `url(${savedMedia.backgroundImage})`;
            } else {
                document.body.style.backgroundImage = 'none';
            }
            
            if (savedMedia.animationSpeed) animationSpeed.value = savedMedia.animationSpeed;
            if (savedMedia.animationDirection) {
                animationDirection.value = savedMedia.animationDirection;
                currentAnimationDirection = savedMedia.animationDirection;
            }
        }
        
        // تطبيق اسم الموقع المحفوظ
        function applySavedSiteName() {
            const savedSiteName = localStorage.getItem('extension_site_name');
            if (savedSiteName) {
                siteNameElement.textContent = savedSiteName;
                siteTitleElement.textContent = `${savedSiteName} - متجر إلكتروني`;
            }
        }
        
        // عرض خيارات الألوان
        function renderColorPickers() {
            const colorPickers = {
                'bg-color-picker': ['dark-bg', 'medium-bg', 'light-bg'],
                'primary-color-picker': ['primary-color', 'secondary-color', 'accent-color'],
                'text-color-picker': ['text-color'],
                'button-color-picker': ['button-color'],
                'cart-color-picker': ['cart-color']
            };
            
            for (const [pickerId, colorTypes] of Object.entries(colorPickers)) {
                const picker = document.getElementById(pickerId);
                picker.innerHTML = '';
                
                colorPalette.forEach(colorObj => {
                    const colorOption = document.createElement('div');
                    colorOption.className = 'color-option';
                    colorOption.style.backgroundColor = colorObj.color;
                    colorOption.setAttribute('data-color', colorObj.color);
                    colorOption.setAttribute('data-type', colorTypes[0]);
                    colorOption.title = colorObj.name;
                    
                    const savedColors = JSON.parse(localStorage.getItem('extension_colors')) || {};
                    const currentColor = savedColors[colorTypes[0]];
                    if (currentColor === colorObj.color) {
                        colorOption.classList.add('active');
                    }
                    
                    picker.appendChild(colorOption);
                });
            }
        }
        
        // بدء حركة الصورة المتحركة
        function startFloatingAnimation() {
            stopFloatingAnimation();
            
            let posX = Math.random() * (window.innerWidth - 80);
            let posY = Math.random() * (window.innerHeight - 80);
            let speedX = (Math.random() - 0.5) * animationSpeed.value;
            let speedY = (Math.random() - 0.5) * animationSpeed.value;
            let angle = 0;
            let radius = 100;
            
            floatingImageInterval = setInterval(() => {
                if (currentAnimationDirection === 'random') {
                    posX += speedX;
                    posY += speedY;
                    if (posX <= 0 || posX >= window.innerWidth - 80) speedX = -speedX;
                    if (posY <= 0 || posY >= window.innerHeight - 80) speedY = -speedY;
                } 
                else if (currentAnimationDirection === 'horizontal') {
                    posX += speedX;
                    if (posX <= 0 || posX >= window.innerWidth - 80) speedX = -speedX;
                } 
                else if (currentAnimationDirection === 'vertical') {
                    posY += speedY;
                    if (posY <= 0 || posY >= window.innerHeight - 80) speedY = -speedY;
                } 
                else if (currentAnimationDirection === 'circular') {
                    angle += 0.02 * animationSpeed.value;
                    posX = window.innerWidth / 2 + Math.cos(angle) * radius - 40;
                    posY = window.innerHeight / 2 + Math.sin(angle) * radius - 40;
                }
                
                floatingImage.style.left = `${posX}px`;
                floatingImage.style.top = `${posY}px`;
            }, 50);
        }
        
        // إيقاف حركة الصورة المتحركة
        function stopFloatingAnimation() {
            if (floatingImageInterval) {
                clearInterval(floatingImageInterval);
            }
        }
        
        // عرض الأقسام
        function renderCategories() {
            categoriesContainer.innerHTML = '';
            
            const allCategory = document.createElement('div');
            allCategory.className = `category ${currentCategory === 'الكل' ? 'active' : ''}`;
            allCategory.textContent = 'الكل';
            allCategory.addEventListener('click', () => {
                currentCategory = 'الكل';
                renderCategories();
                renderProducts();
            });
            categoriesContainer.appendChild(allCategory);
            
            categories.forEach(category => {
                const categoryElement = document.createElement('div');
                categoryElement.className = `category ${currentCategory === category ? 'active' : ''}`;
                categoryElement.textContent = category;
                categoryElement.addEventListener('click', () => {
                    currentCategory = category;
                    renderCategories();
                    renderProducts();
                });
                categoriesContainer.appendChild(categoryElement);
            });
        }
        
        // تحديث خيارات الأقسام في نموذج الإضافة
        function updateCategoryOptions() {
            productCategorySelect.innerHTML = '<option value="">اختر القسم</option>';
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                productCategorySelect.appendChild(option);
            });
        }
        
        // عرض قائمة الأقسام في لوحة التحكم
        function renderCategoriesList() {
            categoriesList.innerHTML = '';
            categories.forEach((category, index) => {
                const li = document.createElement('li');
                li.style.marginBottom = '10px';
                li.style.display = 'flex';
                li.style.justifyContent = 'space-between';
                li.style.alignItems = 'center';
                
                const span = document.createElement('span');
                span.textContent = category;
                
                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = 'حذف';
                deleteBtn.style.background = 'var(--error-color)';
                deleteBtn.style.color = 'white';
                deleteBtn.style.border = 'none';
                deleteBtn.style.padding = '5px 10px';
                deleteBtn.style.borderRadius = '4px';
                deleteBtn.style.cursor = 'pointer';
                deleteBtn.addEventListener('click', () => {
                    if (confirm(`هل أنت متأكد من حذف قسم "${category}"؟`)) {
                        categories.splice(index, 1);
                        localStorage.setItem('extension_categories', JSON.stringify(categories));
                        renderCategoriesList();
                        updateCategoryOptions();
                        showNotification('تم حذف القسم');
                    }
                });
                
                li.appendChild(span);
                li.appendChild(deleteBtn);
                categoriesList.appendChild(li);
            });
        }
        
        // عرض الرسائل
        function renderMessages() {
            messagesContainer.innerHTML = '';
            
            if (messages.length === 0) {
                messagesContainer.innerHTML = '<p style="text-align: center; padding: 20px;">لا توجد رسائل حالياً</p>';
                return;
            }
            
            messages.forEach(message => {
                const messageElement = document.createElement('div');
                messageElement.className = 'message-item';
                messageElement.innerHTML = `
                    <div class="message-content">${message.content}</div>
                    <div class="message-date">${message.date}</div>
                `;
                messagesContainer.appendChild(messageElement);
            });
        }
        
        // عرض قائمة الرسائل في لوحة التحكم
        function renderAdminMessagesList() {
            adminMessagesList.innerHTML = '';
            
            if (messages.length === 0) {
                adminMessagesList.innerHTML = '<p style="text-align: center; padding: 20px;">لا توجد رسائل حالياً</p>';
                return;
            }
            
            messages.forEach((message, index) => {
                const messageElement = document.createElement('div');
                messageElement.className = 'message-item';
                messageElement.innerHTML = `
                    <div class="message-content">${message.content}</div>
                    <div class="message-date">${message.date}</div>
                    <button class="remove-product" data-index="${index}" style="margin-top: 10px;">حذف الرسالة</button>
                `;
                adminMessagesList.appendChild(messageElement);
            });
            
            document.querySelectorAll('#admin-messages-list .remove-product').forEach(button => {
                button.addEventListener('click', (e) => {
                    const index = e.target.getAttribute('data-index');
                    removeMessage(index);
                });
            });
        }
        
        // عرض المنتجات
        function renderProducts() {
            productsGallery.innerHTML = '';
            
            const filteredProducts = currentCategory === 'الكل' 
                ? products 
                : products.filter(product => product.category === currentCategory);
            
            if (filteredProducts.length === 0) {
                productsGallery.innerHTML = '<p style="grid-column: 1 / -1; text-align: center; padding: 20px;">لا توجد منتجات في هذا القسم</p>';
                return;
            }
            
            filteredProducts.forEach((product) => {
                const productElement = document.createElement('div');
                productElement.className = `product ${product.sold ? 'sold' : ''}`;
                productElement.innerHTML = `
                    <div class="product-image">
                        <img src="${product.image}" alt="${product.title}">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">${product.title}</h3>
                        <p class="product-price">${product.price}</p>
                        <p class="product-description">${product.description}</p>
                        <div class="product-actions">
                            <button class="add-to-cart" data-id="${product.id}" ${product.sold ? 'disabled style="opacity: 0.5;"' : ''}>
                                ${product.sold ? 'تم البيع' : 'إضافة إلى السلة'}
                                <span class="cart-icon-btn">🛒</span>
                            </button>
                            <button class="remove-product" data-id="${product.id}">حذف</button>
                            <button class="mark-as-sold" data-id="${product.id}">${product.sold ? 'إلغاء البيع' : 'تم البيع'}</button>
                        </div>
                    </div>
                `;
                productsGallery.appendChild(productElement);
            });
            
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = e.target.closest('.add-to-cart').getAttribute('data-id');
                    addToCart(productId);
                });
            });
            
            document.querySelectorAll('.remove-product').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = e.target.getAttribute('data-id');
                    removeProduct(productId);
                });
            });
            
            document.querySelectorAll('.mark-as-sold').forEach(button => {
                button.addEventListener('click', (e) => {
                    const productId = e.target.getAttribute('data-id');
                    toggleSoldStatus(productId);
                });
            });
            
            document.querySelectorAll('.product-image img').forEach(img => {
                img.addEventListener('click', (e) => {
                    expandedImage.src = e.target.src;
                    imageModal.style.display = 'flex';
                });
            });
        }
        
        // إضافة منتج إلى السلة
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            
            if (!product || product.sold) {
                alert('هذا المنتج غير متاح أو تم بيعه');
                return;
            }
            
            cart.push(product);
            localStorage.setItem('extension_cart', JSON.stringify(cart));
            updateUI();
            showNotification('تمت الإضافة إلى السلة');
        }
        
        // إزالة منتج من السلة
        function removeFromCart(index) {
            cart.splice(index, 1);
            localStorage.setItem('extension_cart', JSON.stringify(cart));
            updateCartModal();
            updateUI();
            showNotification('تم حذف المنتج من السلة');
        }
        
        // إزالة منتج
        function removeProduct(productId) {
            if (confirm('هل أنت متأكد من حذف هذا المنتج؟')) {
                const index = products.findIndex(p => p.id === productId);
                if (index !== -1) {
                    products.splice(index, 1);
                    localStorage.setItem('extension_products', JSON.stringify(products));
                    updateUI();
                    showNotification('تم حذف المنتج');
                }
            }
        }
        
        // إزالة رسالة
        function removeMessage(index) {
            if (confirm('هل أنت متأكد من حذف هذه الرسالة؟')) {
                messages.splice(index, 1);
                localStorage.setItem('extension_messages', JSON.stringify(messages));
                renderAdminMessagesList();
                renderMessages();
                showNotification('تم حذف الرسالة');
            }
        }
        
        // تغيير حالة البيع
        function toggleSoldStatus(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                product.sold = !product.sold;
                localStorage.setItem('extension_products', JSON.stringify(products));
                updateUI();
                showNotification(product.sold ? 'تم标记 المنتج كمباع' : 'تم إلغاء标记 المنتج كمباع');
            }
        }
        
        // تحديث modal السلة
        function updateCartModal() {
            cartItemsContainer.innerHTML = '';
            
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="empty-cart-message">السلة فارغة</p>';
                cartTotalElement.textContent = 'المجموع: 0 ر.س';
                return;
            }
            
            cart.forEach((item, index) => {
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <img src="${item.image}" alt="${item.title}">
                    <div class="cart-item-info">
                        <div class="cart-item-title">${item.title}</div>
                        <div class="cart-item-price">${item.price}</div>
                    </div>
                    <button class="remove-from-cart" data-index="${index}">×</button>
                `;
                cartItemsContainer.appendChild(cartItem);
            });
            
            cartTotalElement.textContent = `المجموع: ${cart.length} منتج`;
            
            document.querySelectorAll('.remove-from-cart').forEach(button => {
                button.addEventListener('click', (e) => {
                    const index = e.target.getAttribute('data-index');
                    removeFromCart(index);
                });
            });
        }
        
        // إضافة منتج جديد (للمدير)
        function addNewProduct(e) {
            e.preventDefault();
            
            const title = document.getElementById('product-title').value;
            const price = document.getElementById('product-price').value;
            const category = document.getElementById('product-category').value;
            const description = document.getElementById('product-description').value;
            const imageFile = productImageInput.files[0];
            
            if (!imageFile) {
                alert('يرجى اختيار صورة للمنتج');
                return;
            }
            
            if (!category) {
                alert('يرجى اختيار قسم للمنتج');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const newProduct = {
                    id: Date.now().toString(),
                    title,
                    price: price,
                    category,
                    description,
                    image: e.target.result,
                    sold: false
                };
                
                products.push(newProduct);
                localStorage.setItem('extension_products', JSON.stringify(products));
                
                addProductForm.reset();
                fileNameSpan.textContent = 'لم يتم اختيار صورة';
                updateUI();
                showNotification('تم إضافة المنتج بنجاح');
            };
            reader.readAsDataURL(imageFile);
        }
        
        // إضافة قسم جديد
        function addNewCategory(e) {
            e.preventDefault();
            
            const name = document.getElementById('category-name').value;
            
            if (categories.includes(name)) {
                alert('هذا القسم موجود بالفعل');
                return;
            }
            
            categories.push(name);
            localStorage.setItem('extension_categories', JSON.stringify(categories));
            
            document.getElementById('category-name').value = '';
            updateUI();
            showNotification('تم إضافة القسم بنجاح');
        }
        
        // إضافة رسالة جديدة
        function addNewMessage(e) {
            e.preventDefault();
            
            const content = document.getElementById('message-content').value;
            const date = new Date().toLocaleDateString('ar-SA');
            
            const newMessage = {
                content,
                date
            };
            
            messages.push(newMessage);
            localStorage.setItem('extension_messages', JSON.stringify(messages));
            
            addMessageForm.reset();
            renderAdminMessagesList();
            renderMessages();
            showNotification('تم إضافة الرسالة بنجاح');
        }
        
        // تغيير كلمة المرور
        function changePassword(e) {
            e.preventDefault();
            
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            
            if (currentPassword !== adminPassword) {
                alert('كلمة المرور الحالية غير صحيحة');
                return;
            }
            
            adminPassword = newPassword;
            localStorage.setItem('extension_password', adminPassword);
            changePasswordForm.reset();
            showNotification('تم تغيير كلمة المرور بنجاح');
        }
        
        // تغيير اسم الموقع
        function changeSiteName(e) {
            e.preventDefault();
            
            const newName = newSiteNameInput.value;
            if (!newName.trim()) {
                alert('يرجى إدخال اسم جديد للموقع');
                return;
            }
            
            siteNameElement.textContent = newName;
            siteTitleElement.textContent = `${newName} - متجر إلكتروني`;
            localStorage.setItem('extension_site_name', newName);
            changeSiteNameForm.reset();
            showNotification('تم تغيير اسم الموقع بنجاح');
        }
        
        // التعامل مع دخول المدير
        function toggleAdmin() {
            if (isAdmin) {
                isAdmin = false;
                localStorage.setItem('extension_admin', 'false');
            } else {
                const password = prompt('أدخل كلمة المرور للإدارة:');
                if (password === adminPassword) {
                    isAdmin = true;
                    localStorage.setItem('extension_admin', 'true');
                } else {
                    alert('كلمة المرور غير صحيحة');
                }
            }
            updateUI();
        }
        
        // التعامل مع عملية الشراء
        function handlePurchase() {
            updateCartModal();
            purchaseModal.style.display = 'flex';
        }
        
        // تأكيد عملية الشراء
        function confirmPurchase() {
            purchaseModal.style.display = 'none';
            
            navigator.clipboard.writeText('@Y_XX').then(() => {
                telegramModal.style.display = 'flex';
                cart = [];
                localStorage.setItem('extension_cart', JSON.stringify(cart));
                updateUI();
            });
        }
        
        // تغيير الألوان
        function changeColor(color, type) {
            document.documentElement.style.setProperty(`--${type}`, color);
            const savedColors = JSON.parse(localStorage.getItem('extension_colors')) || {};
            savedColors[type] = color;
            localStorage.setItem('extension_colors', JSON.stringify(savedColors));
        }
        
        // إعادة تعيين الألوان
        function resetColors() {
            const defaultColors = {
                'dark-bg': '#121212',
                'medium-bg': '#1e1e1e',
                'light-bg': '#2d2d2d',
                'primary-color': '#0a3d2d',
                'secondary-color': '#117a4e',
                'accent-color': '#1aa86a',
                'text-color': '#f1f1f1',
                'button-color': '#0a3d2d',
                'cart-color': '#1aa86a'
            };
            
            for (const [key, value] of Object.entries(defaultColors)) {
                document.documentElement.style.setProperty(`--${key}`, value);
            }
            
            localStorage.setItem('extension_colors', JSON.stringify(defaultColors));
            showNotification('تم إعادة تعيين الألوان إلى الافتراضية');
            renderColorPickers();
        }
        
        // إضافة فيديو الجوال
        function addMobileVideo(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const savedMedia = JSON.parse(localStorage.getItem('extension_media')) || {};
                savedMedia.mobileVideo = e.target.result;
                localStorage.setItem('extension_media', JSON.stringify(savedMedia));
                
                bannerVideo.src = e.target.result;
                mobileVideoBanner.style.display = 'block';
                videoFileName.textContent = file.name;
                showNotification('تم إضافة الفيديو بنجاح');
            };
            reader.readAsDataURL(file);
        }
        
        // إزالة فيديو الجوال
        function removeMobileVideo() {
            const savedMedia = JSON.parse(localStorage.getItem('extension_media')) || {};
            delete savedMedia.mobileVideo;
            localStorage.setItem('extension_media', JSON.stringify(savedMedia));
            
            bannerVideo.src = '';
            mobileVideoBanner.style.display = 'none';
            videoFileName.textContent = 'لم يتم اختيار فيديو';
            showNotification('تم إزالة الفيديو');
        }
        
        // إضافة صورة متحركة
        function addFloatingImage(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const savedMedia = JSON.parse(localStorage.getItem('extension_media')) || {};
                savedMedia.floatingImage = e.target.result;
                localStorage.setItem('extension_media', JSON.stringify(savedMedia));
                
                floatingImage.src = e.target.result;
                floatingImage.style.display = 'block';
                floatingImageVisible = true;
                floatingImageFileName.textContent = file.name;
                startFloatingAnimation();
                showNotification('تم إضافة الصورة المتحركة بنجاح');
            };
            reader.readAsDataURL(file);
        }
        
        // إزالة الصورة المتحركة
        function removeFloatingImage() {
            const savedMedia = JSON.parse(localStorage.getItem('extension_media')) || {};
            delete savedMedia.floatingImage;
            localStorage.setItem('extension_media', JSON.stringify(savedMedia));
            
            floatingImage.src = '';
            floatingImage.style.display = 'none';
            floatingImageVisible = false;
            floatingImageFileName.textContent = 'لم يتم اختيار صورة';
            stopFloatingAnimation();
            showNotification('تم إزالة الصورة المتحركة');
        }
        
        // تغيير إعدادات الصورة المتحركة
        function updateAnimationSettings() {
            const savedMedia = JSON.parse(localStorage.getItem('extension_media')) || {};
            savedMedia.animationSpeed = animationSpeed.value;
            savedMedia.animationDirection = animationDirection.value;
            localStorage.setItem('extension_media', JSON.stringify(savedMedia));
            
            currentAnimationDirection = animationDirection.value;
            
            if (floatingImageVisible) {
                startFloatingAnimation();
            }
        }
        
        // إضافة خلفية الموقع
        function addBackgroundImage(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const savedMedia = JSON.parse(localStorage.getItem('extension_media')) || {};
                savedMedia.backgroundImage = e.target.result;
                localStorage.setItem('extension_media', JSON.stringify(savedMedia));
                
                document.body.style.backgroundImage = `url(${e.target.result})`;
                backgroundFileName.textContent = file.name;
                showNotification('تم إضافة خلفية الموقع بنجاح');
            };
            reader.readAsDataURL(file);
        }
        
        // إزالة خلفية الموقع
        function removeBackgroundImage() {
            const savedMedia = JSON.parse(localStorage.getItem('extension_media')) || {};
            delete savedMedia.backgroundImage;
            localStorage.setItem('extension_media', JSON.stringify(savedMedia));
            
            document.body.style.backgroundImage = 'none';
            backgroundFileName.textContent = 'لم يتم اختيار صورة خلفية';
            showNotification('تم إزالة خلفية الموقع');
        }
        
        // عرض الإشعار
        function showNotification(message) {
            notification.textContent = message;
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.display = 'none';
            }, 2000);
        }
        
        // تبديل علامات التبويب في لوحة التحكم
        function switchAdminTab(tabName) {
            adminTabs.forEach(tab => {
                if (tab.getAttribute('data-tab') === tabName) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            adminTabContents.forEach(content => {
                if (content.id === `admin-${tabName}`) {
                    content.style.display = 'block';
                } else {
                    content.style.display = 'none';
                }
            });
        }
        
        // تبديل الأقسام الرئيسية
        function switchSection(sectionName) {
            currentSection = sectionName;
            updateUI();
        }
        
        // إعداد مستمعي الأحداث
        function setupEventListeners() {
            cartIcon.addEventListener('click', handlePurchase);
            adminLogin.addEventListener('click', toggleAdmin);
            addProductForm.addEventListener('submit', addNewProduct);
            addCategoryForm.addEventListener('submit', addNewCategory);
            addMessageForm.addEventListener('submit', addNewMessage);
            changePasswordForm.addEventListener('submit', changePassword);
            changeSiteNameForm.addEventListener('submit', changeSiteName);
            closeModal.addEventListener('click', () => { purchaseModal.style.display = 'none'; });
            closeTelegramModal.addEventListener('click', () => { telegramModal.style.display = 'none'; });
            closeImageModal.addEventListener('click', () => { imageModal.style.display = 'none'; });
            closeBanner.addEventListener('click', removeMobileVideo);
            confirmPurchaseButton.addEventListener('click', confirmPurchase);
            resetColorsButton.addEventListener('click', resetColors);
            removeVideoButton.addEventListener('click', removeMobileVideo);
            removeFloatingImageButton.addEventListener('click', removeFloatingImage);
            removeBackgroundButton.addEventListener('click', removeBackgroundImage);
            
            productImageInput.addEventListener('change', function() {
                fileNameSpan.textContent = this.files.length > 0 ? this.files[0].name : 'لم يتم اختيار صورة';
            });
            
            mobileVideoInput.addEventListener('change', addMobileVideo);
            floatingImageInput.addEventListener('change', addFloatingImage);
            backgroundImageInput.addEventListener('change', addBackgroundImage);
            animationSpeed.addEventListener('input', updateAnimationSettings);
            animationDirection.addEventListener('change', updateAnimationSettings);
            
            window.addEventListener('click', (e) => {
                if (e.target === purchaseModal) purchaseModal.style.display = 'none';
                if (e.target === telegramModal) telegramModal.style.display = 'none';
                if (e.target === imageModal) imageModal.style.display = 'none';
            });
            
            const logoData = localStorage.getItem('extension_logo');
            if (logoData) siteLogo.src = logoData;
            
            logoContainer.addEventListener('click', () => {
                if (!isAdmin) return;
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(e) {
                    const file = e.target.files[0];
                    if (!file) return;
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        siteLogo.src = e.target.result;
                        localStorage.setItem('extension_logo', e.target.result);
                        showNotification('تم تغيير الشعار بنجاح');
                    };
                    reader.readAsDataURL(file);
                };
                input.click();
            });
            
            adminTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    switchAdminTab(tab.getAttribute('data-tab'));
                });
            });
            
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    switchSection(link.getAttribute('data-section'));
                });
            });
            
            telegramLinkElement.addEventListener('click', () => {
                navigator.clipboard.writeText('@Y_XX');
                showNotification('تم نسخ معرف Telegram');
            });
            
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('color-option')) {
                    const color = e.target.getAttribute('data-color');
                    const type = e.target.getAttribute('data-type');
                    const parent = e.target.parentElement;
                    parent.querySelectorAll('.color-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    e.target.classList.add('active');
                    changeColor(color, type);
                }
            });
        }
        
        // تهيئة التطبيق
        function init() {
            if (products.length === 0) {
                products = [
                    {
                        id: '1',
                        title: 'بوزر انستا',
                        price: '5 ر.س',
                        category: 'تقسامات مواد',
                        description: 'بوزر انستا شبه رياعي مع رقم في البوزر',
                        image: 'https://via.placeholder.com/300x200/117a4e/ffffff?text=بوزر+انستا',
                        sold: false
                    },
                    {
                        id: '2',
                        title: 'منتج مثال 2',
                        price: '200 ر.س',
                        category: 'تقسامات مواد',
                        description: 'هذا وصف لمنتج مثال يظهر في المعرض',
                        image: 'https://via.placeholder.com/300x200/0a3d2d/ffffff?text=منتج+2',
                        sold: false
                    },
                    {
                        id: '3',
                        title: 'منتج مثال 3',
                        price: '150 ر.س',
                        category: 'ارقام وهيبة',
                        description: 'هذا وصف لمنتج مثال يظهر في المعرض',
                        image: 'https://via.placeholder.com/300x200/1aa86a/ffffff?text=منتج+3',
                        sold: false
                    }
                ];
                localStorage.setItem('extension_products', JSON.stringify(products));
            }
            
            updateUI();
            setupEventListeners();
        }
        
        // بدء التطبيق
        init();
    </script>
</body>
</html>